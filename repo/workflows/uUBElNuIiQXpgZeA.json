{
  "createdAt": "2025-05-05T11:20:53.728Z",
  "updatedAt": "2025-05-29T18:07:00.463Z",
  "id": "uUBElNuIiQXpgZeA",
  "name": "docx to xml",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "fileSelector": "=temp/{{ $('Webhook').item.json.body.file_id }}/word/document.xml",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        1040,
        220
      ],
      "id": "1f3bd0d3-4ec7-48f5-9274-0498b5ac8fa8",
      "name": "read word/document.xml",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "path": "6f775615-7ea3-4adb-a461-adaad2de73f4",
        "responseMode": "responseNode",
        "options": {
          "rawBody": true
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -160,
        540
      ],
      "id": "2b165718-c47e-4603-848a-9dc86ad2ca7f",
      "name": "Webhook",
      "webhookId": "6f775615-7ea3-4adb-a461-adaad2de73f4"
    },
    {
      "parameters": {
        "respondWith": "binary",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1260,
        220
      ],
      "id": "bb39978f-da58-4018-9f0a-21cbab9c9c4f",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "respondWith": "binary",
        "responseDataSource": "set",
        "inputFieldName": "=data",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1320,
        560
      ],
      "id": "f4a75e8d-fec7-4426-ad2c-f0269f9b9735",
      "name": "Respond to Webhook1"
    },
    {
      "parameters": {
        "content": "## Docx to xml\n",
        "height": 260,
        "width": 1020
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        800,
        140
      ],
      "id": "3b1234f1-7926-48ea-89fd-f41d8fbd0675",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## PPTX to xml",
        "height": 260,
        "width": 1020
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        800,
        480
      ],
      "id": "3eb5b878-576d-4542-91e1-5f3a6088df80",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ $json.body.file_id }}.zip",
        "options": {
          "append": false
        }
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        160,
        540
      ],
      "id": "eebc64b3-6e79-4b5c-9298-89b18cdde2e5",
      "name": "Write the file to disk"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "a3eea8a8-4f3d-433d-adc4-84156ac4f4e2",
                    "leftValue": "={{ $('Webhook').item.json.body.type }}",
                    "rightValue": "docx",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "docx"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.type }}",
                    "rightValue": "pptx",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "7b533b0a-bed9-41e1-86f3-4e163beb4757"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pptx"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        540,
        540
      ],
      "id": "8b8de379-0f38-4c30-b972-d31d2e4dc19b",
      "name": "PPT/Doc?"
    },
    {
      "parameters": {
        "command": "=#!/bin/bash\n\nFILE_ID=\"{{ $json.body.file_id }}\"\nZIP_FILE=\"${FILE_ID}.zip\"\nDEST_FOLDER=\"temp/${FILE_ID}\"\nTEMP_UNZIP_DIR=\"tmp_unzip_${FILE_ID}\"\n\n# Step 1: Clean up if already exists\nrm -rf \"$DEST_FOLDER\"\nrm -rf \"$TEMP_UNZIP_DIR\"\n\n# Step 2: Create necessary directories\nmkdir -p \"$DEST_FOLDER\"\nmkdir -p \"$TEMP_UNZIP_DIR\"\n\n# Step 3: Unzip into temporary location\nunzip -q \"$ZIP_FILE\" -d \"$TEMP_UNZIP_DIR\"\n\n# Step 4: Move extracted contents into grouped folder\nmv \"$TEMP_UNZIP_DIR\"/* \"$DEST_FOLDER\"\n\n# Step 5: Clean up temp unzip dir\nrm -rf \"$TEMP_UNZIP_DIR\"\n\n# Final confirmation\necho \"✅ Extracted files moved to $DEST_FOLDER\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        820,
        220
      ],
      "id": "c9362fc3-89ab-476b-82e2-893d1cda9c6d",
      "name": "unzip doc"
    },
    {
      "parameters": {
        "command": "=#!/bin/bash\n\nFILE_ID=\"{{ $json.body.file_id }}\"\nZIP_FILE=\"${FILE_ID}.zip\"\nEXTRACT_DIR=\"${FILE_ID}_extracted_ppt\"\nOUTPUT_FILE=\"/tmp/${FILE_ID}_combined.xml\"\n\n# Ensure the extracted directory is clean (delete if it exists)\nrm -rf \"$EXTRACT_DIR\"\nmkdir -p \"$EXTRACT_DIR\"\n\n# Unzip into the clean directory\nunzip -q \"$ZIP_FILE\" -d \"$EXTRACT_DIR\"\n\n# Create or empty the output file\n> \"$OUTPUT_FILE\"\n\n# Find and merge all XML files\nfind \"$EXTRACT_DIR\" -type f -name \"*.xml\" | sort | while read -r file; do\n  echo \"<!-- $file -->\" >> \"$OUTPUT_FILE\"\n  cat \"$file\" >> \"$OUTPUT_FILE\"\n  echo \"\" >> \"$OUTPUT_FILE\"\ndone\n\n# Confirm completion\necho \"✅ XMLs merged successfully into $OUTPUT_FILE\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        840,
        560
      ],
      "id": "c8e4f585-d747-48dd-8ccd-1e1e092ef19d",
      "name": "unzip ppt"
    },
    {
      "parameters": {
        "command": "=rm -rf temp/{{ $('Webhook').item.json.body.file_id }}/*"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        1500,
        220
      ],
      "id": "6de5f6a5-8d39-4cb5-8c6e-b45eaadb4492",
      "name": "Clear Doc"
    },
    {
      "parameters": {
        "command": "=rm -rf /tmp/{{ $('Webhook').item.json.body.file_id }}_combined.xml"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        1620,
        560
      ],
      "id": "5c69488b-fd96-43da-b4e5-0ceaa194ac49",
      "name": "Clear PPT"
    },
    {
      "parameters": {
        "fileSelector": "=/tmp/{{ $('Webhook').item.json.body.file_id }}_combined.xml",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        1060,
        560
      ],
      "id": "3662658e-5dfe-4d98-839d-5328bb2bca8d",
      "name": "read tmp/combined.xml",
      "alwaysOutputData": true
    }
  ],
  "connections": {
    "read word/document.xml": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Write the file to disk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Clear Doc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook1": {
      "main": [
        [
          {
            "node": "Clear PPT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write the file to disk": {
      "main": [
        [
          {
            "node": "PPT/Doc?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PPT/Doc?": {
      "main": [
        [
          {
            "node": "unzip doc",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "unzip ppt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "unzip doc": {
      "main": [
        [
          {
            "node": "read word/document.xml",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "unzip ppt": {
      "main": [
        [
          {
            "node": "read tmp/combined.xml",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear Doc": {
      "main": [
        []
      ]
    },
    "Clear PPT": {
      "main": [
        []
      ]
    },
    "read tmp/combined.xml": {
      "main": [
        [
          {
            "node": "Respond to Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "61e11e01-b322-4b9f-88ca-ad35be1d277c",
  "triggerCount": 1,
  "tags": [],
  "shared": [
    {
      "createdAt": "2025-05-05T11:20:53.728Z",
      "updatedAt": "2025-05-05T11:20:53.728Z",
      "role": "workflow:owner",
      "workflowId": "uUBElNuIiQXpgZeA",
      "projectId": "IQ4w3zW02fJzIdTt",
      "project": {
        "createdAt": "2025-01-25T02:11:56.995Z",
        "updatedAt": "2025-01-25T21:11:21.957Z",
        "id": "IQ4w3zW02fJzIdTt",
        "name": "Yonatan Tesfaye <yonatantesfaye30@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null
      }
    }
  ]
}