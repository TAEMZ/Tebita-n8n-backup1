{
  "createdAt": "2025-06-18T08:40:51.237Z",
  "updatedAt": "2025-06-25T05:53:32.362Z",
  "id": "tuJWiVqX14TqBHn0",
  "name": "influxermerch",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "url": "={{ $json.direction !== null \n    ? `https://influxermerch.com/athletes?direction=next&cursor=${$json.cursor}&_data=${$json._data}` \n    : 'https://influxermerch.com/athletes?_data=routes/($locale).athletes._index' \n}}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "direction",
              "value": "={{ $json.direction }}"
            },
            {
              "name": "cursor",
              "value": "={{ $json.cursor }}"
            },
            {
              "name": "_data",
              "value": "={{ $json._data }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -80,
        240
      ],
      "id": "fa15208f-66db-4708-8061-f5f77f618c25",
      "name": "HTTP Request3"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1suQC8_3Q5ILTEHpXjewsJSv1SwnN2yDFHzKaVdaZwis",
          "mode": "list",
          "cachedResultName": "influxermerch",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1suQC8_3Q5ILTEHpXjewsJSv1SwnN2yDFHzKaVdaZwis/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1suQC8_3Q5ILTEHpXjewsJSv1SwnN2yDFHzKaVdaZwis/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ID": "={{ $json.id }}",
            "NAME": "={{ $json.title }}",
            "SPORT": "={{ $json.sport.value }}",
            "SCHOOL": "={{ $json.school.value }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID",
              "displayName": "ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "NAME",
              "displayName": "NAME",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "SPORT",
              "displayName": "SPORT",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "SCHOOL",
              "displayName": "SCHOOL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        680,
        -20
      ],
      "id": "8806f9de-a63b-429f-9d25-1edc66b8c21a",
      "name": "Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MYJ51fHpcG8U7E9j",
          "name": "Google Sheets account 7"
        }
      }
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "direction"
            },
            {
              "name": "cursor"
            },
            {
              "name": "_data"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -840,
        220
      ],
      "id": "cb2a3b80-d121-4fa5-9fbe-1491b0e7a472",
      "name": "When Executed by Another Workflow",
      "disabled": true
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "tuJWiVqX14TqBHn0",
          "mode": "list",
          "cachedResultName": "influxermerch"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "direction": "next",
            "_data": "routes/($locale).athletes._index",
            "cursor": "={{ $json.athletes.pageInfo.endCursor }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cursor",
              "displayName": "cursor",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "_data",
              "displayName": "_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": false
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        580,
        320
      ],
      "id": "9472b53e-5d34-414d-8183-e58c99afa60d",
      "name": "Execute Workflow"
    },
    {
      "parameters": {
        "content": "## Id\n## Name\n## Sport\n## School",
        "height": 360,
        "width": 320
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -180,
        60
      ],
      "typeVersion": 1,
      "id": "5e985b04-6d5b-4d7a-828b-6b2cf0dd9f1a",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## cursor",
        "height": 240,
        "width": 260
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        260,
        740
      ],
      "typeVersion": 1,
      "id": "4cfa873d-8d45-477e-a333-943d49cf7460",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "path": "96a73154-fe6a-4253-8a48-280e4d532855",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -840,
        460
      ],
      "id": "93fa6a2c-d005-4247-97a0-65d1f7a0cce2",
      "name": "Webhook",
      "webhookId": "96a73154-fe6a-4253-8a48-280e4d532855"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a7f9dd37-7c2a-4b7c-b49e-ccffe3f5eca4",
              "name": "direction",
              "value": "={{ $json.direction }}",
              "type": "string"
            },
            {
              "id": "a0574392-ef1e-4449-bb5e-b022496d6495",
              "name": "cursor",
              "value": "={{ $json.cursor }}",
              "type": "string"
            },
            {
              "id": "30d2778d-77bb-48aa-8d69-996f984963c1",
              "name": "_data",
              "value": "={{ $json._data }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -480,
        220
      ],
      "id": "b21b9b85-ca20-47b0-bdae-98f5f1decb0d",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsCode": "const results = [];\n\nfor (const item of $input.all()) {\n  const html = item.json.data;\n\n  // Match athlete <a> blocks\n  const athleteBlocks = html.match(/<a class=\"grid group\".*?<\\/a>/gs) || [];\n\n  for (const block of athleteBlocks) {\n    const nameMatch = block.match(/<h6[^>]*>(.*?)<\\/h6>/i);\n    const name = nameMatch ? nameMatch[1].trim() : '';\n\n    const idMatch = block.match(/href=\"\\/athletes\\/(.*?)\"/i);\n    const id = idMatch ? idMatch[1].trim() : '';\n\n    const pMatches = block.match(/<p[^>]*group-hover:text[^>]*>(.*?)<\\/p>/gi) || [];\n\n    const sport = pMatches.length > 0\n      ? pMatches[0].replace(/<\\/?[^>]+(>|$)/g, \"\").trim()\n      : '';\n\n    const university = pMatches.length > 1\n      ? pMatches[1].replace(/<\\/?[^>]+(>|$)/g, \"\").trim()\n      : '';\n\n    results.push({\n      json: {\n        name,\n        id,\n        sport,\n        university,\n      }\n    });\n  }\n\n  // Extract cursor info from HTML\n  const cursorMatch = html.match(/\"pageInfo\":\\s*({.*?})\\s*}[),]/s);\n\n  if (cursorMatch) {\n    try {\n      const pageInfo = JSON.parse(cursorMatch[1]);\n\n      results.push({\n        json: {\n          cursor: pageInfo.endCursor || null,\n          hasNextPage: pageInfo.hasNextPage,\n          hasPreviousPage: pageInfo.hasPreviousPage,\n        }\n      });\n    } catch (err) {\n      results.push({\n        json: {\n          error: \"Failed to parse pageInfo\",\n          details: err.message,\n        }\n      });\n    }\n  } else {\n    results.push({\n      json: {\n        warning: \"No pageInfo block found in HTML\"\n      }\n    });\n  }\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        340,
        820
      ],
      "id": "289c38ad-5fa4-4c83-90c4-994b9147aeec",
      "name": "Code1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "athletes.nodes",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        320,
        80
      ],
      "id": "64318f68-ed22-4ea5-8156-af6ca1efff2a",
      "name": "Split Out"
    }
  ],
  "connections": {
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          },
          {
            "node": "Execute Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        []
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        []
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "n8n.tebita.com",
            "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36",
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
            "accept-encoding": "gzip, br",
            "accept-language": "en-US,en;q=0.6",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "196.189.121.28",
            "cf-ipcountry": "ET",
            "cf-ray": "9520e4b62b22e177-MRS",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "cookie": "n8n-auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjczNDY4YTU0LTc3MTgtNGQyYS1hZThiLTZlODZjNjJhZDYyMCIsImhhc2giOiJRQTI2NXU2Y1huIiwiYnJvd3NlcklkIjoiMGhWNHlDbXdPS0dmVlpEb01xWE1xdGZYeVlNZWtpNnI3T1RpTmtQZHI1az0iLCJpYXQiOjE3NTAxNTkxMzQsImV4cCI6MTc1MDc2MzkzNH0.ipyWtH7kaMDgz1lCkUTUyvp3geWRq5nqtidI4DdFE9A",
            "if-none-match": "W/\"22-6OS7cK0FzqnV2NeDHdOSGS1bVUs\"",
            "priority": "u=0, i",
            "sec-ch-ua": "\"Brave\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"Linux\"",
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "none",
            "sec-fetch-user": "?1",
            "sec-gpc": "1",
            "upgrade-insecure-requests": "1",
            "x-forwarded-for": "172.68.234.129",
            "x-forwarded-host": "n8n.tebita.com",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "e66488ee7e04",
            "x-real-ip": "172.68.234.129"
          },
          "params": {},
          "query": {},
          "body": {},
          "webhookUrl": "https://n8n.tebita.com/webhook/96a73154-fe6a-4253-8a48-280e4d532855",
          "executionMode": "production"
        }
      }
    ]
  },
  "versionId": "279c547e-9833-48bf-a3d4-430d2e759eda",
  "triggerCount": 1,
  "tags": [],
  "shared": [
    {
      "createdAt": "2025-06-18T08:40:51.237Z",
      "updatedAt": "2025-06-18T08:40:51.237Z",
      "role": "workflow:owner",
      "workflowId": "tuJWiVqX14TqBHn0",
      "projectId": "IQ4w3zW02fJzIdTt",
      "project": {
        "createdAt": "2025-01-25T02:11:56.995Z",
        "updatedAt": "2025-01-25T21:11:21.957Z",
        "id": "IQ4w3zW02fJzIdTt",
        "name": "Yonatan Tesfaye <yonatantesfaye30@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null
      }
    }
  ]
}